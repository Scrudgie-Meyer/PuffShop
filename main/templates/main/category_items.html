{% extends 'main/layout.html' %}

{% block title %} Home {% endblock %}

{% block main %}
    <main class="container my-5">
        <div class="row">
            <!-- Filter Section -->
            <aside class="col-md-3 mb-4">
                <h4>Filters</h4>
                <form>
                    <div class="form-group">
                        <label for="category">Category</label>
                        <select class="form-control" id="category">
                            <option>All</option>
                            <option>Sofas</option>
                            <option>Chairs</option>
                            <option>Tables</option>
                            <option>Beds</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="priceRange">Price Range</label>
                        <input type="range" class="form-control-range" id="priceRange" min="0" max="1000" step="50">
                        <div class="d-flex justify-content-between">
                            <span>$0</span>
                            <span>$1000</span>
                        </div>
                    </div>

                        <div class="form-group">
                            <form method="get" action=".">
                                {% for attr, values in attributes.items %}
                                    <div class="filter-section">
                                        <label class="filter-label" onclick="toggleFilter('{{ attr }}')">{{ attr }}</label>
                                        <div class="form-check" id="filter-{{ attr }}">
                                            {% for value in values %}
                                                <label class="form-check-label">
                                                    <input type="checkbox" class="form-check-input" name="{{ attr }}" value="{{ value }}" {% if value in selected_filters.values %}checked{% endif %}>
                                                    {{ value }}
                                                </label>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% endfor %}
                                <button type="submit" class="btn btn-primary mt-3">Apply Filters</button>
                            </form>
                        </div>

                </form>
            </aside>
            <!-- Product Catalog -->
            <div class="col-md-9">
                <h2 class="mb-4">Product Catalog</h2>
                <div class="row">
                    {% for item in items %}
                        <div class="col-md-4">
                            <a href="{% url 'item_detail' item.id %}" class="category-card-link">
                                <div class="card mb-4">
                                    <div class="card-img-container">
                                        <img src="{{ item.image_urls.0 }}" class="card-img-top" alt="Product 1">
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title">{{ item.name }}</h5>
                                        <p class="card-text">${{ item.price }}</p>
                                        <a href="{% url 'add_to_cart' item.id %}" class="btn btn-primary">Add to Cart</a>
                                    </div>
                                </div>
                            </a>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </main>

{#    <h1>Items</h1>#}
{##}
{#    <h2>Filter by attributes</h2>#}
{#    <form method="get" action=".">#}
{#        {% for attr, values in attributes.items %}#}
{#            <h3>{{ attr }}</h3>#}
{#            {% for value in values %}#}
{#                <label>#}
{#                    <input type="checkbox" name="{{ attr }}" value="{{ value }}" {% if value in selected_filters.values %}checked{% endif %}>#}
{#                    {{ value }}#}
{#                </label><br>#}
{#            {% endfor %}#}
{#        {% endfor %}#}
{#        <button type="submit">Filter</button>#}
{#    </form>#}
{##}
{#    <h2>Items</h2>#}
{#    <div class="item-list">#}
{#        {% for item in items %}#}
{#            <div class="item">#}
{#                <h3>{{ item.name }}</h3>#}
{#                <p>{{ item.description }}</p>#}
{#                <p>Price: ${{ item.price }}</p>#}
{#                <p>Quantity: {{ item.quantity }}</p>#}
{#                <p>Category: {{ item.category.name }}</p>#}
{#                <img src="{{ item.image_urls.0 }}" alt="{{ item.name }}">#}
{#                <h4>Attributes:</h4>#}
{#                <ul>#}
{#                    {% for key, value in item.attributes.items %}#}
{#                        <li>{{ key }}: {{ value }}</li>#}
{#                    {% endfor %}#}
{#                </ul>#}
{#            </div>#}
{#        {% endfor %}#}
{#    </div>#}
    <script>
        function toggleFilter(attr) {
            var element = document.getElementById('filter-' + attr);
            var label = document.querySelector('[onclick="toggleFilter(\'' + attr + '\')"]');
            if (element.style.display === "none" || element.style.display === "") {
                element.style.display = "block";
                label.classList.add('open');
            } else {
                element.style.display = "none";
                label.classList.remove('open');
            }
        }

        // Закриття всіх списків за замовчуванням
        document.addEventListener('DOMContentLoaded', function() {
            var filters = document.querySelectorAll('.form-check');
            filters.forEach(function(filter) {
                filter.style.display = 'none';
            });
        });
    </script>

{% endblock %}